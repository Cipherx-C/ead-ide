<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma de Ensino e IDE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.21.3/min/vs/editor/editor.main.css">
    <style>
        body {
            display: flex;
            justify-content: space-between;
            height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
        }
        .section {
            flex: 1;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
        }
        #left-section {
            background-color: #f0f0f0;
        }
        #middle-section {
            background-color: #e0e0e0;
            border-left: 1px solid #ccc;
            border-right: 1px solid #ccc;
            display: flex;
            flex-direction: column;
        }
        #right-section {
            background-color: #f8f8f8;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .file-list {
            list-style-type: none;
            padding: 0;
            margin-top: 10px;
        }
        .file-list li {
            margin-left: 20px;
            margin-bottom: 5px;
            cursor: pointer;
        }
        .file-list li.folder {
            cursor: pointer;
        }
        .file-list li:hover {
            background-color: #ddd;
        }
        .editor-container {
            flex: 1;
            position: relative;
            display: flex;
            flex-direction: column;
            height: 40%;
        }
        #editor {
            flex: 1;
            border: 1px solid #ccc;
            min-height: 0;
        }
        #run-button {
            margin-top: 10px;
        }
        .tab {
            cursor: pointer;
            padding: 10px;
            background-color: #ddd;
            border: 1px solid #ccc;
            border-bottom: none;
        }
        .tab.active {
            background-color: #f0f0f0;
        }
        .tabs {
            display: flex;
        }
        .congrats-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            padding: 20px;
            text-align: center;
            z-index: 9999;
        }
        .congrats-message h2 {
            font-size: 24px;
            margin-bottom: 15px;
        }
        .congrats-message button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }
        .congrats-message button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div id="left-section" class="section">
        <h2>Área de Ensino</h2>
        <p>Esta seção contém explicações e tutoriais.</p>
        <p>Para criar um projeto web simples com HTML, CSS e JavaScript, siga o exemplo abaixo:</p>
        <p>Exemplo: <code>console.log('Olá, mundo!');</code></p>
        <p>Seu projeto deve conter um arquivo HTML, um arquivo CSS e um arquivo JavaScript que façam o seguinte:</p>
        <ul>
            <li>O HTML deve incluir um elemento <code>div</code> com a classe <code>container</code>.</li>
            <li>O CSS deve definir o fundo do corpo da página como azul claro.</li>
            <li>O JavaScript deve adicionar um ouvinte de eventos a um botão que exiba um alerta quando clicado.</li>
        </ul>
    </div>
    <div id="middle-section" class="section">
        <h2>IDE com Pastas e Arquivos</h2>
        <div id="file-explorer">
            <h3>Explorador de Arquivos</h3>
            <ul id="file-list" class="file-list">
                <li class="folder">/public
                    <ul>
                        <li class="file" onclick="loadFile('index.html')">index.html</li>
                        <li class="file" onclick="loadFile('style.css')">style.css</li>
                        <li class="file" onclick="loadFile('script.js')">script.js</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="editor-container">
            <div class="tabs">
                <div class="tab active" onclick="switchTab('html')">HTML</div>
                <div class="tab" onclick="switchTab('css')">CSS</div>
                <div class="tab" onclick="switchTab('js')">JavaScript</div>
            </div>
            <div id="editor"></div>
            <button id="run-button" onclick="runCode()">Executar</button>
        </div>
    </div>
    <div id="right-section" class="section">
        <h2>Área de Resultados</h2>
        <iframe id="result-frame"></iframe>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.21.3/min/vs/loader.js"></script>
    <script>
        var editors = {
            html: null,
            css: null,
            js: null
        };

        var currentTab = 'html';

        require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.21.3/min/vs' }});
        require(['vs/editor/editor.main'], function() {
            editors.html = monaco.editor.create(document.getElementById('editor'), {
                value: '',
                language: 'html',
                automaticLayout: true
            });

            editors.css = monaco.editor.create(document.getElementById('editor'), {
                value: '',
                language: 'css',
                automaticLayout: true
            });

            editors.js = monaco.editor.create(document.getElementById('editor'), {
                value: '',
                language: 'javascript',
                automaticLayout: true
            });

            switchTab('html');
        });

        function loadFile(filename) {
            var fileContent = fileSystem[filename] || '';
            var extension = filename.split('.').pop();
            var editor = editors[extension];
            editor.setValue(fileContent);
        }

        function switchTab(tab) {
            currentTab = tab;
            for (var key in editors) {
                editors[key].getDomNode().style.display = key === tab ? 'block' : 'none';
            }

            document.querySelectorAll('.tab').forEach(function(el) {
                el.classList.remove('active');
            });
            document.querySelector('.tab[onclick="switchTab(\'' + tab + '\')"]').classList.add('active');
        }

        function runCode() {
            var htmlCode = editors.html.getValue();
            var cssCode = editors.css.getValue();
            var jsCode = editors.js.getValue();

            var resultFrame = document.getElementById('result-frame');
            var resultDocument = resultFrame.contentDocument || resultFrame.contentWindow.document;
            resultDocument.open();
            resultDocument.write(`
                <style>${cssCode}</style>
                ${htmlCode}
                <script>${jsCode}<\/script>
            `);
            resultDocument.close();

            // Validar código
            var htmlContains = htmlCode.includes('<div class="container">');
            var cssContains = cssCode.includes('body { background-color: lightblue; }');
            var jsContains = jsCode.includes('addEventListener("click", function() { alert("Botão clicado!"); })');

            if (htmlContains && cssContains && jsContains) {
                showCongratulations();
            } else {
                alert('Ainda não está completo. Continue trabalhando!');
            }
        }

        function showCongratulations() {
            var congratsDiv = document.createElement('div');
            congratsDiv.classList.add('congrats-message');
            congratsDiv.innerHTML = `
                <h2>Parabéns! Você completou o desafio!</h2>
                <button onclick="nextLesson()">Próxima Lição</button>
                <button onclick="closeCongratulations()">Ficar</button>
            `;
            document.body.appendChild(congratsDiv);
        }

        function nextLesson() {
            console.log('Avançar para a próxima lição...');
            window.location.reload();
        }

        function closeCongratulations() {
            var congratsDiv = document.querySelector('.congrats-message');
            if (congratsDiv) {
                congratsDiv.remove();
            }
        }

        function initFileExplorer() {
            var fileExplorer = document.getElementById('file-explorer');
            var folders = fileExplorer.getElementsByClassName('folder');
            var i;

            for (i = 0; i < folders.length; i++) {
                folders[i].addEventListener('click', function() {
                    this.classList.toggle('active');
                    var content = this.nextElementSibling;
                    if (content.style.display === 'block') {
                        content.style.display = 'none';
                    } else {
                        content.style.display = 'block';
                    }
                });
            }

            var files = fileExplorer.getElementsByClassName('file');
            for (i = 0; i < files.length; i++) {
                files[i].addEventListener('click', function() {
                    var selectedFile = fileExplorer.querySelector('.file.selected');
                    if (selectedFile) {
                        selectedFile.classList.remove('selected');
                    }
                    this.classList.add('selected');
                    loadFile(this.textContent);
                });
            }
        }

        var fileSystem = {
            'index.html': '<!DOCTYPE html><html><head><title>Exemplo</title></head><body><h1>Olá, mundo!</h1><p>Este é um parágrafo de exemplo.</p><button>Botão de Teste</button><div class="container"><p>Dentro de um container estilizado.</p></div></body></html>',
            'style.css': 'body { background-color: lightblue; } h1 { color: navy; } .container { background-color: white; border: 1px solid black; padding: 10px; }',
            'script.js': 'document.querySelector("button").addEventListener("click", function() { alert("Botão clicado!"); });'
        };

        initFileExplorer();
    </script>
</body>
</html>
